![collaboration-logo](../IM/Github_image_banner.png)

# **Quality Assessment of Long-Read Nanopore Data**

Quality control is a fundamental step in any sequencing workflow, serving as the foundation for reliable downstream analyses. Unlike short-read sequencing technologies, Oxford Nanopore Technologies (ONT) generates long reads with variable lengths and different error profiles that require specialized quality assessment approaches. Raw Nanopore data often exhibits unique characteristics including:

- **Variable Read Lengths**: Nanopore sequencing can produce reads ranging from hundreds of bases to over 100kb, creating a wide distribution that needs careful evaluation.

- **Quality Score Distribution**: Nanopore reads typically have quality scores (Q-scores) centered around 10-12, which differs significantly from Illumina data and requires specialized interpretation.

- **Time-dependent Quality**: Unlike other sequencing platforms, Nanopore sequencing quality can vary over time as the flow cell degrades, making temporal analysis crucial.

- **Channel-specific Performance**: The physical layout of the MinION flow cell with its 512 channels can show varying performance, requiring spatial analysis of sequencing quality.

Understanding these unique characteristics through proper quality control ensures that subsequent analyses, such as genome assembly, variant calling, or metagenomics, are built upon reliable data.

## Introduction to NanoPlot

**NanoPlot** is a specialized visualization and quality control tool developed specifically for long-read sequencing data from Oxford Nanopore Technologies and Pacific Biosciences. As part of the comprehensive **NanoPack** suite, NanoPlot addresses the unique challenges of long-read data analysis by providing tailored visualizations and statistics that standard tools like FastQC cannot adequately handle.

Key features of NanoPlot include:

- **Multi-format Support**: Accepts various input formats including FASTQ files (compressed or uncompressed), FASTA files, BAM/uBAM files, sequencing summary files from basecallers like Guppy or Albacore, and specialized formats like feather/arrow files.

- **Comprehensive Visualizations**: Generates multiple plot types including read length distributions, quality score distributions, length vs. quality scatter plots, temporal analysis plots, and flow cell activity heatmaps.

- **Statistical Summaries**: Produces detailed statistics including N50 values, total reads and bases, quality metrics, and GC content analysis through the companion NanoStats output.

- **Flexible Output**: Creates both static PNG plots and interactive HTML reports, allowing for both publication-ready figures and interactive data exploration.

- **Performance Optimization**: Written in Python3 with efficient data processing capabilities, making it suitable for large datasets typical of long-read sequencing projects.

- **Customizable Analysis**: Offers extensive filtering and transformation options, including quality thresholds, length filtering, downsampling, and logarithmic transformations.

NanoPlot has been benchmarked and widely adopted in the genomics community, providing researchers with essential insights into their Nanopore sequencing data quality and characteristics.

## Example Usage of NanoPlot for Nanopore FASTQ Data

To perform comprehensive quality control analysis on your Nanopore sequencing data using NanoPlot, follow these steps:

1. **Install `NanoPlot`**: You can install NanoPlot using `conda`:

   ```bash
   conda install -c bioconda nanoplot
   ```

2. **Basic Quality Control Analysis**: Execute the following command to analyze your Nanopore FASTQ data:

   ```bash
   NanoPlot --fastq nanopore_reads.fastq.gz --outdir nanoplot_output --prefix sample_01
   ```

3. **Advanced Analysis with Filtering and Options**: For more comprehensive analysis with quality filtering and additional options:

   ```bash
   NanoPlot --fastq nanopore_reads.fastq.gz \
            --outdir nanoplot_qc_results \
            --prefix nanopore_sample \
            --minqual 7 \
            --minlength 500 \
            --maxlength 50000 \
            --loglength \
            --plots dot kde \
            --threads 4 \
            --store
   ```

4. **Analysis Using Sequencing Summary File**: If you have access to the sequencing summary file generated by the basecaller:

   ```bash
   NanoPlot --summary sequencing_summary.txt \
            --outdir summary_qc_output \
            --loglength \
            --plots hex dot \
            --threads 8
   ```

## Parameter Explanations

**Input Options**:

- `--fastq nanopore_reads.fastq.gz`: Specifies the input FASTQ file containing Nanopore reads. Supports gzip, bzip2, and bgzip compression.

- `--summary sequencing_summary.txt`: Alternative input using the sequencing summary file generated by Guppy, Albacore, or MinKNOW basecallers. This provides additional metadata for enhanced analysis.

**Output Control**:

- `--outdir nanoplot_qc_results`: Designates the directory where NanoPlot will store all output files, including plots, statistics, and HTML reports.

- `--prefix nanopore_sample`: Adds a custom prefix to all output files, useful for organizing results from multiple samples or runs.

**Quality Filtering Options**:

- `--minqual 7`: Filters out reads with average quality scores below the specified threshold. A value of 7 is commonly used as it represents the default "pass" threshold for Guppy basecalling.

- `--minlength 500`: Excludes reads shorter than the specified length (in base pairs). Helps focus analysis on longer, more informative reads.

- `--maxlength 50000`: Removes reads longer than the specified threshold, useful for excluding potential chimeric reads or outliers.

- `--drop_outliers`: Automatically removes reads with extremely long lengths that may represent artifacts or concatenated reads.

**Visualization Options**:

- `--loglength`: Adds logarithmic scaling to length-based plots, improving visualization when read lengths span several orders of magnitude.

- `--plots dot kde`: Specifies plot types to generate. Options include 'dot' for scatter plots, 'kde' for kernel density estimation plots, and 'hex' for hexagonal binning plots.

- `--no_static`: Prevents generation of static PNG plots, producing only interactive HTML plots for web-based analysis.

**Performance Settings**:

- `--threads 4`: Allocates the specified number of CPU cores for parallel processing, significantly reducing analysis time for large datasets.

- `--downsample 10000`: Randomly samples the specified number of reads for analysis, useful for quick quality checks on very large datasets.

**Data Storage and Format**:

- `--store`: Saves the processed data in a pickle format for rapid reanalysis or integration with other NanoPack tools.

- `--tsv_stats`: Outputs statistics in tab-separated values format instead of the default text format, facilitating integration with downstream analysis pipelines.

After running NanoPlot, examine the generated HTML report (`prefix_NanoPlot-report.html`) for comprehensive quality metrics and the various plots to assess read length distributions, quality scores, and potential issues with your sequencing data.

### References

- De Coster, W., D'Hert, S., Schultz, D. T., Cruts, M., & Van Broeckhoven, C. (2018). **NanoPack: visualizing and processing long-read sequencing data**. *Bioinformatics*, 34(15), 2666â€“2669. https://doi.org/10.1093/bioinformatics/bty149

- NanoPlot GitHub Repository: [https://github.com/wdecoster/NanoPlot](https://github.com/wdecoster/NanoPlot)

- NanoPack Documentation: [https://github.com/wdecoster/nanopack](https://github.com/wdecoster/nanopack)

- Oxford Nanopore Technologies QC Guidelines: [https://nanoporetech.com/support/software/data-analysis/should-i-qc-my-data-and-what-tools-to-use](https://nanoporetech.com/support/software/data-analysis/should-i-qc-my-data-and-what-tools-to-use)