![collaboration-logo](../IM/Github_image_banner.png)

# **Penilaian Kualitas Data Long-Read Nanopore**

Quality control adalah langkah fundamental dalam setiap workflow sekuensing, berfungsi sebagai fondasi untuk analisis downstream yang dapat diandalkan. Berbeda dengan teknologi sekuensing short-read, Oxford Nanopore Technologies (ONT) menghasilkan long reads dengan panjang bervariasi dan profil error yang berbeda yang memerlukan pendekatan penilaian kualitas khusus. Data Nanopore mentah sering menunjukkan karakteristik unik termasuk:

- **Panjang Read yang Bervariasi**: Sekuensing Nanopore dapat menghasilkan reads mulai dari ratusan basa hingga lebih dari 100kb, menciptakan distribusi yang luas yang memerlukan evaluasi yang cermat.

- **Distribusi Quality Score**: Reads Nanopore biasanya memiliki quality scores (Q-scores) yang berpusat sekitar 10-12, yang berbeda secara signifikan dari data Illumina dan memerlukan interpretasi khusus.

- **Kualitas yang Bergantung Waktu**: Berbeda dengan platform sekuensing lainnya, kualitas sekuensing Nanopore dapat bervariasi seiring waktu karena flow cell mengalami degradasi, membuat analisis temporal menjadi krusial.

- **Performa Spesifik Channel**: Layout fisik flow cell MinION dengan 512 channel dapat menunjukkan performa yang bervariasi, memerlukan analisis spasial dari kualitas sekuensing.

Memahami karakteristik unik ini melalui kontrol kualitas yang tepat memastikan bahwa analisis selanjutnya, seperti genome assembly, variant calling, atau metagenomik, dibangun berdasarkan data yang dapat diandalkan.

## Pengenalan NanoPlot

**NanoPlot** adalah tool visualisasi dan kontrol kualitas khusus yang dikembangkan secara spesifik untuk data sekuensing long-read dari Oxford Nanopore Technologies dan Pacific Biosciences. Sebagai bagian dari suite **NanoPack** yang komprehensif, NanoPlot mengatasi tantangan unik dari analisis data long-read dengan menyediakan visualisasi dan statistik yang disesuaikan yang tidak dapat ditangani secara memadai oleh tools standar seperti FastQC.

Fitur utama NanoPlot meliputi:

- **Dukungan Multi-format**: Menerima berbagai format input termasuk file FASTQ (terkompresi atau tidak), file FASTA, file BAM/uBAM, file sequencing summary dari basecaller seperti Guppy atau Albacore, dan format khusus seperti file feather/arrow.

- **Visualisasi Komprehensif**: Menghasilkan berbagai jenis plot termasuk distribusi panjang read, distribusi quality score, scatter plot panjang vs kualitas, plot analisis temporal, dan heatmap aktivitas flow cell.

- **Ringkasan Statistik**: Menghasilkan statistik detail termasuk nilai N50, total reads dan bases, metrik kualitas, dan analisis konten GC melalui output NanoStats yang menyertainya.

- **Output Fleksibel**: Membuat plot PNG statis dan laporan HTML interaktif, memungkinkan baik figur siap publikasi maupun eksplorasi data interaktif.

- **Optimisasi Performa**: Ditulis dalam Python3 dengan kemampuan pemrosesan data yang efisien, membuatnya cocok untuk dataset besar yang khas dari proyek sekuensing long-read.

- **Analisis yang Dapat Dikustomisasi**: Menawarkan opsi filtering dan transformasi yang ekstensif, termasuk threshold kualitas, filtering panjang, downsampling, dan transformasi logaritmik.

NanoPlot telah di-benchmark dan diadopsi luas dalam komunitas genomik, memberikan peneliti wawasan penting tentang kualitas dan karakteristik data sekuensing Nanopore mereka.

## Contoh Penggunaan NanoPlot untuk Data FASTQ Nanopore

Untuk melakukan analisis kontrol kualitas komprehensif pada data sekuensing Nanopore Anda menggunakan NanoPlot, ikuti langkah-langkah berikut:

1. **Install `NanoPlot`**: Anda dapat menginstal NanoPlot menggunakan `conda`:

   ```bash
   conda install -c bioconda nanoplot
   ```

2. **Analisis Quality Control Dasar**: Eksekusi perintah berikut untuk menganalisis data FASTQ Nanopore Anda:

   ```bash
   NanoPlot --fastq nanopore_reads.fastq.gz --outdir nanoplot_output --prefix sample_01
   ```

3. **Analisis Lanjutan dengan Filtering dan Opsi**: Untuk analisis yang lebih komprehensif dengan filtering kualitas dan opsi tambahan:

   ```bash
   NanoPlot --fastq nanopore_reads.fastq.gz \
            --outdir nanoplot_qc_results \
            --prefix nanopore_sample \
            --minqual 7 \
            --minlength 500 \
            --maxlength 50000 \
            --loglength \
            --plots dot kde \
            --threads 4 \
            --store
   ```

4. **Analisis Menggunakan Sequencing Summary File**: Jika Anda memiliki akses ke file sequencing summary yang dihasilkan oleh basecaller:

   ```bash
   NanoPlot --summary sequencing_summary.txt \
            --outdir summary_qc_output \
            --loglength \
            --plots hex dot \
            --threads 8
   ```

## Penjelasan Parameter

**Opsi Input**:

- `--fastq nanopore_reads.fastq.gz`: Menentukan file input FASTQ yang berisi reads Nanopore. Mendukung kompresi gzip, bzip2, dan bgzip.

- `--summary sequencing_summary.txt`: Input alternatif menggunakan file sequencing summary yang dihasilkan oleh basecaller Guppy, Albacore, atau MinKNOW. Ini menyediakan metadata tambahan untuk analisis yang lebih baik.

**Kontrol Output**:

- `--outdir nanoplot_qc_results`: Menentukan direktori tempat NanoPlot akan menyimpan semua file output, termasuk plot, statistik, dan laporan HTML.

- `--prefix nanopore_sample`: Menambahkan prefix kustom ke semua file output, berguna untuk mengorganisir hasil dari beberapa sampel atau run.

**Opsi Quality Filtering**:

- `--minqual 7`: Menyaring reads dengan skor kualitas rata-rata di bawah threshold yang ditentukan. Nilai 7 umumnya digunakan karena merepresentasikan threshold "pass" default untuk basecalling Guppy.

- `--minlength 500`: Mengecualikan reads yang lebih pendek dari panjang yang ditentukan (dalam pasang basa). Membantu fokus analisis pada reads yang lebih panjang dan informatif.

- `--maxlength 50000`: Menghapus reads yang lebih panjang dari threshold yang ditentukan, berguna untuk mengecualikan kemungkinan reads kimerik atau outlier.

- `--drop_outliers`: Secara otomatis menghapus reads dengan panjang sangat ekstrem yang mungkin merepresentasikan artefak atau reads yang tergabung.

**Opsi Visualisasi**:

- `--loglength`: Menambahkan skala logaritmik ke plot berbasis panjang, memperbaiki visualisasi ketika panjang read mencakup beberapa order magnitude.

- `--plots dot kde`: Menentukan jenis plot yang akan dihasilkan. Opsi termasuk 'dot' untuk scatter plot, 'kde' untuk plot estimasi kepadatan kernel, dan 'hex' untuk plot binning heksagonal.

- `--no_static`: Mencegah pembuatan plot PNG statis, hanya menghasilkan plot HTML interaktif untuk analisis berbasis web.

**Pengaturan Performa**:

- `--threads 4`: Mengalokasikan jumlah core CPU yang ditentukan untuk pemrosesan paralel, secara signifikan mengurangi waktu analisis untuk dataset besar.

- `--downsample 10000`: Mengambil sampel acak sejumlah reads yang ditentukan untuk analisis, berguna untuk pengecekan kualitas cepat pada dataset yang sangat besar.

**Penyimpanan Data dan Format**:

- `--store`: Menyimpan data yang telah diproses dalam format pickle untuk reanalisis cepat atau integrasi dengan tools NanoPack lainnya.

- `--tsv_stats`: Mengeluarkan statistik dalam format tab-separated values alih-alih format teks default, memfasilitasi integrasi dengan pipeline analisis downstream.

Setelah menjalankan NanoPlot, periksa laporan HTML yang dihasilkan (`prefix_NanoPlot-report.html`) untuk metrik kualitas komprehensif dan berbagai plot untuk menilai distribusi panjang read, quality scores, dan kemungkinan masalah dengan data sekuensing Anda.

### Referensi

- De Coster, W., D'Hert, S., Schultz, D. T., Cruts, M., & Van Broeckhoven, C. (2018). **NanoPack: visualizing and processing long-read sequencing data**. *Bioinformatics*, 34(15), 2666â€“2669. https://doi.org/10.1093/bioinformatics/bty149

- NanoPlot GitHub Repository: [https://github.com/wdecoster/NanoPlot](https://github.com/wdecoster/NanoPlot)

- NanoPack Documentation: [https://github.com/wdecoster/nanopack](https://github.com/wdecoster/nanopack)

- Oxford Nanopore Technologies QC Guidelines: [https://nanoporetech.com/support/software/data-analysis/should-i-qc-my-data-and-what-tools-to-use](https://nanoporetech.com/support/software/data-analysis/should-i-qc-my-data-and-what-tools-to-use)
